<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <apiVersion>57.0</apiVersion>
    <label>Complicated Security Test Flow</label>

    <!-- Variables -->
    <variables>
        <variable name="userEmail" dataType="String" />
        <variable name="userPassword" dataType="String" />
        <variable name="apiToken" dataType="String" />
        <variable name="unusedVar1" dataType="String" />
        <variable name="unusedVar2" dataType="String" />
        <variable name="httpLink" dataType="String" />
    </variables>

    <!-- Assignment 1: Hardcoded credentials -->
    <elements>
        <element type="Assignment" name="AssignSecrets">
            <assignmentItems>
                <value>
                    <stringValue>SuperSecretPassword123!</stringValue>
                </value>
                <variable>userPassword</variable>
            </assignmentItems>
            <assignmentItems>
                <value>
                    <stringValue>abc123TOKENXYZ</stringValue>
                </value>
                <variable>apiToken</variable>
            </assignmentItems>
        </element>
    </elements>

    <!-- Assignment 2: Hardcoded Salesforce ID and email -->
    <elements>
        <element type="Assignment" name="AssignIdsAndEmails">
            <assignmentItems>
                <value>
                    <stringValue>0010Y00000ABCDE123</stringValue>
                </value>
                <variable>unusedVar1</variable>
            </assignmentItems>
            <assignmentItems>
                <value>
                    <stringValue>test.user@example.com</stringValue>
                </value>
                <variable>unusedVar2</variable>
            </assignmentItems>
        </element>
    </elements>

    <!-- Assignment 3: Unsafe HTTP and embedded HTML -->
    <elements>
        <element type="Assignment" name="UnsafeContent">
            <assignmentItems>
                <value>
                    <stringValue>http://insecure.example.com/api</stringValue>
                </value>
                <variable>httpLink</variable>
            </assignmentItems>
            <assignmentItems>
                <value>
                    <stringValue>&lt;script&gt;alert('XSS');&lt;/script&gt;</stringValue>
                </value>
                <variable>unusedVar2</variable>
            </assignmentItems>
        </element>
    </elements>

    <!-- GetRecords without filters (SOQL Injection risk) -->
    <elements>
        <element type="GetRecords" name="GetAllAccounts">
            <getRecords>
                <object>Account</object>
                <!-- Missing filter -->
            </getRecords>
        </element>
    </elements>

    <!-- Log sensitive info -->
    <elements>
        <element type="Action" name="LogSecrets">
            <actionType>FlowAction</actionType>
            <inputs>
                <inputReference>userPassword</inputReference>
                <inputReference>apiToken</inputReference>
            </inputs>
        </element>
    </elements>

    <!-- Decision with no conditions -->
    <elements>
        <element type="Decision" name="EmptyDecisionNode">
            <!-- No conditions defined -->
        </element>
    </elements>

</Flow>
